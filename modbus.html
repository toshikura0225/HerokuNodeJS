<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>modbus dummy INV</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript">

	function md(event)
	{
		alert(event.data);
	}
	
	function received(arg1, arg2)
	{
		$('div').prepend(data + '<br>');
		webiopi().callMacro("serialWrite", 1234, serialReceived );
		//$('#idFrame')[0].contentWindow.fr();
		
	}
	
	function serialReceived( macro, args, data )
	{
		// pythonからの返り値をそのままNode.jsに返す
		alert(data);
		var win = $('#idFrame')[0].contentWindow;
		win.postMessage(data, "http://www.geocities.jp");
	}

if(window.addEventListener){
	addEventListener('message', md, false);
}
else{
	attachEvent('onmessage', md);
}

</script>
</head>
<body>

<div></div>

<button type="button" onclick="received('aaa','bbb')">call iframe script</button>

<iframe id="idFrame" src="http://www.geocities.jp/t_kuramata/iframe.html" height=300 width=300>
</iframe>


<iframe id="idFrame" src="iframe.html" height=300 width=300>
</iframe>


</body>
</html>