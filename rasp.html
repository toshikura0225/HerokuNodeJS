<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>rasp</title>
<script src="/socket.io/socket.io.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript" src="http://127.0.0.1:8000/webiopi.js"></script>

<script type="text/javascript">

	var socket;
	$(function() {
		socket = io.connect();
		socket.on('msg', function(data) {
			received('msg', data);
		});
	});
	
	
	function send(url)
	{
		socket.emit('msg', url);
		/*
		$.ajax({
			type: 'POST',
			url: msg,
	
			success: function(data, textStatus){
			  // 成功したとき
			  // data にサーバーから返された html が入る
			  //alert(data);
			},
			error: function(xhr, textStatus, errorThrown){
			  // エラー処理
			  alert("error");
			}
		});
		*/
	}
	// webiopiのloadイベント
	webiopi().ready( function()
	{	// Initialize
		
		
	});
	

	// socket.ioから受信したデータをRPへ渡す（WEB→RP）
	function received(tag, argURL)
	{
		// デバッグ用に<div>に出力
		$('div').prepend(argURL + '<br>');
		
		PostURL(argURL);
	}
	
	function PostURL(argURL)
	{
		// 受信したデータ（URL）にPOSTする
		$.ajax({
			type: 'POST',
			url: argURL,
			success: function(argURL, textStatus){
			  //console.log(data);
			},
			error: function(xhr, textStatus, errorThrown){
			  // エラー処理
			  console.log(textStatus);
			}
		});
		
		// reply OK
		socket.emit('ok', argURL);
	}

</script>
</head>
<body>
	
	<button onclick="PostURL('http://127.0.0.1:8000/GPIO/2/value/1')">pin:2 HIGH</button>
	<br />
	<button onclick="PostURL('http://127.0.0.1:8000/GPIO/2/value/0')">pin:2 LOW</button>
	<br />
	<div></div>

</body>
</html>